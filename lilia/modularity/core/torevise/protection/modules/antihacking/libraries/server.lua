
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
local lastcheck

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
local ban = function(_, client)
    client:Ban(0, false)
    client:Kick("No Exploits!")
end


------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
function MODULE:Think()
    if not lastcheck then lastcheck = CurTime() end
    if CurTime() - lastcheck > 30 then
        local commands, _ = concommand.GetTable()
        for _, cmd in pairs(lia.config.HackCommands) do
            if commands[cmd] then
                net.Start("BanMeAmHack")
                net.SendToServer()
            end
        end

        lastcheck = CurTime()
    end
end


------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
timer.Simple(
    1,
    function()
        for _ = 1, 4 do
            local rand = table.remove(lia.config.LokiNetMessages, math.random(1, #lia.config.LokiNetMessages))
            if not rand then break end
            util.AddNetworkString(rand)
            net.Receive(rand, ban)
        end
    end
)

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
