------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
function AntiGMODExploitsCore:ServerInitializedModules()
    concommand.Remove("lua_run")
    concommand.Remove("lua_openscript")
end

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
function AntiGMODExploitsCore:PlayerSay(client, message)
    if string.match(message, "%d+%.%d+%.%d+%.%d+") ~= nil then
        ProtectionCore:ApplyPunishment(client, "Typing IP addresses in chat", true, false)
        return ""
    end
end

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
function AntiGMODExploitsCore:OnEntityCreated(ent)
    local entity = ent:GetClass():lower():Trim()
    if entity == "lua_run" then
        function entity:AcceptInput()
            return true
        end

        function entity:RunCode()
            return true
        end

        timer.Simple(0, function() entity:Remove() end)
    elseif entity == "point_servercommand" then
        timer.Simple(0, function() entity:Remove() end)
    end
end

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
function AntiGMODExploitsCore:PlayerInitialSpawn(client)
    if not game.SinglePlayer() then
        timer.Simple(
            0,
            function()
                if IsValid(client) == false or client:IsBot() or client:IsListenServerHost() or client.IsFullyAuthenticated == nil or client:IsFullyAuthenticated() then return end
                client:Kick("Your SteamID wasn't fully authenticated, try restarting steam.")
            end
        )
    end
end

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
function AntiGMODExploitsCore:OnPlayerHitGround(client)
    local vel = client:GetVelocity()
    client:SetVelocity(Vector(-(vel.x * 0.45), -(vel.y * 0.45), 0))
end
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
